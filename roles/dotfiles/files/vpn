# basic duke vpn
# sudo openconnect portal.duke.edu -b --user=dfp12 --authgroup=-Default-

# duke health vpn
# sudo openconnect vpn.duhs.duke.edu -b --user=dfp12

# for elevated access
# sudo openconnect dmvpn.duhs.duke.edu -b --user=dfp12

# force split tunnel
HOSTNAMES=(
  10.96.56.216
  apis-dev.ori.duke.edu
  apis.ori.duke.edu
  app-ingress.dev.platform.dukecrucible.net
  app-ingress.prod.platform.dukecrucible.net
  awsportal.duhs.duke.edu
  crucible-platform-dev-ba6b9d28.hcp.eastus.azmk8s.io
  crucible-platform-prod-7cb2b199.hcp.eastus.azmk8s.io
  dev.fulcrum.duke.edu
  dev.snowball.dukecrucible.net
  devguide.dhe.duke.edu
  exdnc-scan1.dhe.duke.edu
  fulcrum.duke.edu
  gitlab.dhe.duke.edu
  groups.oit.duke.edu
  oauth.oit.duke.edu
  prod.fulcrum.duke.edu
  redcap.duke.edu
  sftp.dev.snowball.dukecrucible.net
  sftp.prod.snowball.dukecrucible.net
  smtp.duhs.duke.edu
  snowball-dev.cluster-cropzucl3dtp.us-east-1.docdb.amazonaws.com
  status.platform.dukecrucible.net
  test.fulcrum.duke.edu
  vld-1kp.dhe.duke.edu
  vld-apisdev01.dhe.duke.edu
  vlt-apistest01.dhe.duke.edu
  vlp-apisprod01.dhe.duke.edu
)
SCRIPT="/home/dylan/.local/bin/vpn-slice ${HOSTNAMES[@]}"
{ pass show consulting/duke.edu | head -n 1; echo push; } | \
sudo openconnect vpn.duhs.duke.edu \
    --user=dfp12 \
    --passwd-on-stdin \
    --script="$SCRIPT"
