# bashrc runs for non-login shells, e.g. when you launch gnome-terminal from a desktop

# Aliases
alias ls="/bin/ls --color=auto --ignore='*.pyc'"
alias ll="/bin/ls --color=auto --ignore='*.pyc' -l"
alias la="/bin/ls --color=auto --almost-all"
alias alert='notify-send --urgency=low -i "$([ $? = 0 ] && echo terminal || echo error)" "$(history|tail -n1|sed -e '\''s/^\s*[0-9]\+\s*//;s/[;&|]\s*alert$//'\'')"'
# Set correct term for tmux so solarized theme works in vim
alias tmux="TERM=screen-256color-bce tmux"

function mosht () {
    LC_TMUX_SESSION_NAME=remote /usr/bin/mosh -- "$@"
    printf '\033]2;%s\033\\' $(hostname) # re-set tmux pane to correct title
}

function dev () {
    LC_TMUX_SESSION_NAME=remote TERM= /usr/bin/ssh dev
    printf '\033]2;%s\033\\' $(hostname) # re-set tmux pane to correct title
}

# Set editors
export VISUAL=vim
export EDITOR=vim

# vi mode
set -o vi

# if the LC_TMUX_SESSION_NAME environment variable is set, start tmux
if [ -n "$LC_TMUX_SESSION_NAME" -a $TERM != "screen" ]; then
    echo -ne "\033]0;"${USER}@${HOSTNAME}"\007"  # Set terminal title
    session_name=$USER-$LC_TMUX_SESSION_NAME
    tmux has-session -t $session_name && tmux attach-session -t $session_name || tmux new-session -s $session_name
fi

# Set up dircolors to use solarized colors
if [ -x /usr/bin/dircolors ]; then
  test -r ~/.dir_colors/dircolors && eval "$(dircolors -b ~/.dir_colors/dircolors)" || eval "$(dircolors -b)"
fi

# fzf
export FZF_DEFAULT_COMMAND='ag -g ""'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
if [ -x ~/.fzf ]; then
    source ~/.fzf/shell/completion.bash
    source ~/.fzf/shell/key-bindings.bash
fi

# add local bin to PATH
export PATH=$PATH:~/.local/bin

# set client on esv servers
export CLIENT=$(hostname | python -c 'import sys; import re; print(re.match(r"\w+-(.*)", sys.stdin.read()).groups(1)[0])')
