#!/usr/bin/env python3
# vim: ft=python

import os
import sys
from os.path import abspath, join, exists, dirname


def main():
    eslints = ['tslint', 'eslint']
    for eslint in eslints:
        try:
            eslint = search_up(
                os.getcwd(),
                f'node_modules/.bin/{eslint}'
            )
        except FileNotFoundError:
            continue
        break

    os.execvp(eslint, [eslint] + sys.argv[1:])


def search_up(directory, relative_path):
    while directory != '/':
        if exists(join(directory, relative_path)):
            return abspath(join(directory, relative_path))
        else:
            directory = abspath(join(directory,  '..'))

    raise FileNotFoundError(
        'Didn\'t find {} relative to {} or any of it\'s parent directories'
        .format(relative_path, directory)
    )


if __name__ == '__main__':
    main()
